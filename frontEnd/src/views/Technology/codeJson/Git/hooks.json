{
  "preCommitHook": {
    "title": "pre-commit Hook",
    "language": "bash",
    "code": "#!/bin/sh\n# .git/hooks/pre-commit\n# æäº¤å‰ä»£ç è´¨é‡æ£€æŸ¥\n\necho \"ğŸ” æ‰§è¡Œpre-commitæ£€æŸ¥...\"\n\n# æ£€æŸ¥ä»£ç æ ¼å¼\nnpm run lint\nif [ $? -ne 0 ]; then\n    echo \"âŒ ä»£ç æ ¼å¼æ£€æŸ¥å¤±è´¥\"\n    exit 1\nfi\n\n# è¿è¡Œæµ‹è¯•\nnpm run test\nif [ $? -ne 0 ]; then\n    echo \"âŒ æµ‹è¯•å¤±è´¥\"\n    exit 1\nfi\n\n# æ£€æŸ¥æäº¤æ–‡ä»¶å¤§å°\nfor file in $(git diff --cached --name-only); do\n    if [ -f \"$file\" ]; then\n        size=$(wc -c < \"$file\")\n        if [ $size -gt 1048576 ]; then  # 1MB\n            echo \"âŒ æ–‡ä»¶ $file è¿‡å¤§ (${size} bytes)\"\n            exit 1\n        fi\n    fi\ndone\n\n# æ£€æŸ¥æ•æ„Ÿä¿¡æ¯\nif git diff --cached | grep -E \"(password|secret|key|token)\" > /dev/null; then\n    echo \"âŒ æ£€æµ‹åˆ°å¯èƒ½çš„æ•æ„Ÿä¿¡æ¯\"\n    exit 1\nfi\n\necho \"âœ… pre-commitæ£€æŸ¥é€šè¿‡\"\nexit 0"
  },
  "commitMsgHook": {
    "title": "commit-msg Hook",
    "language": "bash",
    "code": "#!/bin/sh\n# .git/hooks/commit-msg\n# éªŒè¯æäº¤ä¿¡æ¯æ ¼å¼\n\ncommit_regex='^(feat|fix|docs|style|refactor|test|chore|perf|ci|build|revert)(\\(.+\\))?: .{1,50}'\n\ncommit_msg=$(cat $1)\n\nif ! echo \"$commit_msg\" | grep -qE \"$commit_regex\"; then\n    echo \"âŒ æäº¤ä¿¡æ¯æ ¼å¼ä¸æ­£ç¡®\"\n    echo \"æ­£ç¡®æ ¼å¼: <type>(<scope>): <description>\"\n    echo \"ç±»å‹: feat, fix, docs, style, refactor, test, chore, perf, ci, build, revert\"\n    echo \"ç¤ºä¾‹: feat(auth): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½\"\n    echo \"å½“å‰æäº¤ä¿¡æ¯: $commit_msg\"\n    exit 1\nfi\n\n# æ£€æŸ¥æäº¤ä¿¡æ¯é•¿åº¦\nif [ ${#commit_msg} -gt 72 ]; then\n    echo \"âŒ æäº¤ä¿¡æ¯è¿‡é•¿ (${#commit_msg} å­—ç¬¦ï¼Œå»ºè®®ä¸è¶…è¿‡72å­—ç¬¦)\"\n    exit 1\nfi\n\n# æ£€æŸ¥æ˜¯å¦åŒ…å«ä¸­æ–‡\nif echo \"$commit_msg\" | grep -qP '[\\x{4e00}-\\x{9fff}]'; then\n    echo \"âœ… åŒ…å«ä¸­æ–‡æè¿°\"\nfi\n\necho \"âœ… æäº¤ä¿¡æ¯æ ¼å¼æ­£ç¡®\"\nexit 0"
  },
  "prePushHook": {
    "title": "pre-push Hook",
    "language": "bash",
    "code": "#!/bin/sh\n# .git/hooks/pre-push\n# æ¨é€å‰æ£€æŸ¥\n\nremote=\"$1\"\nurl=\"$2\"\n\necho \"ğŸš€ æ‰§è¡Œpre-pushæ£€æŸ¥...\"\necho \"æ¨é€åˆ°: $remote ($url)\"\n\n# æ£€æŸ¥å½“å‰åˆ†æ”¯\ncurrent_branch=$(git rev-parse --abbrev-ref HEAD)\necho \"å½“å‰åˆ†æ”¯: $current_branch\"\n\n# ç¦æ­¢ç›´æ¥æ¨é€åˆ°main/masteråˆ†æ”¯\nif [ \"$current_branch\" = \"main\" ] || [ \"$current_branch\" = \"master\" ]; then\n    echo \"âŒ ç¦æ­¢ç›´æ¥æ¨é€åˆ° $current_branch åˆ†æ”¯\"\n    echo \"è¯·ä½¿ç”¨Pull Requestæµç¨‹\"\n    exit 1\nfi\n\n# æ£€æŸ¥æ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹\nif ! git diff-index --quiet HEAD --; then\n    echo \"âŒ å­˜åœ¨æœªæäº¤çš„æ›´æ”¹\"\n    exit 1\nfi\n\n# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶\necho \"ğŸ§ª è¿è¡Œæµ‹è¯•å¥—ä»¶...\"\nnpm run test:full\nif [ $? -ne 0 ]; then\n    echo \"âŒ æµ‹è¯•å¤±è´¥ï¼Œæ¨é€è¢«é˜»æ­¢\"\n    exit 1\nfi\n\n# æ£€æŸ¥ä»£ç è¦†ç›–ç‡\necho \"ğŸ“Š æ£€æŸ¥ä»£ç è¦†ç›–ç‡...\"\nnpm run test:coverage\nif [ $? -ne 0 ]; then\n    echo \"âš ï¸ ä»£ç è¦†ç›–ç‡æ£€æŸ¥å¤±è´¥\"\n    # å¯ä»¥é€‰æ‹©æ˜¯å¦é˜»æ­¢æ¨é€\n    # exit 1\nfi\n\necho \"âœ… pre-pushæ£€æŸ¥é€šè¿‡\"\nexit 0"
  },
  "preReceiveHook": {
    "title": "pre-receive Hook",
    "language": "bash",
    "code": "#!/bin/sh\n# hooks/pre-receive\n# æœåŠ¡ç«¯æ¥æ”¶å‰æ£€æŸ¥\n\necho \"ğŸ” æœåŠ¡ç«¯pre-receiveæ£€æŸ¥...\"\n\nwhile read oldrev newrev refname; do\n    # è·å–åˆ†æ”¯å\n    branch=$(echo $refname | sed 's/refs\\/heads\\///')\n    echo \"æ£€æŸ¥åˆ†æ”¯: $branch\"\n    \n    # ä¿æŠ¤ä¸»åˆ†æ”¯\n    if [ \"$branch\" = \"main\" ] || [ \"$branch\" = \"master\" ]; then\n        # æ£€æŸ¥æ¨é€è€…æƒé™\n        if [ \"$USER\" != \"admin\" ]; then\n            echo \"âŒ åªæœ‰ç®¡ç†å‘˜å¯ä»¥æ¨é€åˆ° $branch åˆ†æ”¯\"\n            exit 1\n        fi\n    fi\n    \n    # æ£€æŸ¥æäº¤ä¿¡æ¯æ ¼å¼\n    for commit in $(git rev-list $oldrev..$newrev); do\n        msg=$(git log --format=%s -n 1 $commit)\n        if ! echo \"$msg\" | grep -qE '^(feat|fix|docs|style|refactor|test|chore)'; then\n            echo \"âŒ æäº¤ $commit ä¿¡æ¯æ ¼å¼ä¸æ­£ç¡®: $msg\"\n            exit 1\n        fi\n    done\n    \n    # æ£€æŸ¥æ–‡ä»¶å¤§å°\n    for commit in $(git rev-list $oldrev..$newrev); do\n        for file in $(git diff-tree --no-commit-id --name-only -r $commit); do\n            size=$(git cat-file -s $commit:$file 2>/dev/null || echo 0)\n            if [ $size -gt 10485760 ]; then  # 10MB\n                echo \"âŒ æ–‡ä»¶ $file è¿‡å¤§ (${size} bytes)\"\n                exit 1\n            fi\n        done\n    done\ndone\n\necho \"âœ… æœåŠ¡ç«¯æ£€æŸ¥é€šè¿‡\"\nexit 0"
  },
  "postReceiveHook": {
    "title": "post-receive Hook",
    "language": "bash",
    "code": "#!/bin/sh\n# hooks/post-receive\n# æœåŠ¡ç«¯æ¥æ”¶åæ“ä½œ\n\necho \"ğŸ“¨ æ‰§è¡Œpost-receiveæ“ä½œ...\"\n\nwhile read oldrev newrev refname; do\n    branch=$(echo $refname | sed 's/refs\\/heads\\///')\n    \n    echo \"å¤„ç†åˆ†æ”¯: $branch\"\n    echo \"ä» $oldrev åˆ° $newrev\"\n    \n    # ä¸»åˆ†æ”¯è‡ªåŠ¨éƒ¨ç½²\n    if [ \"$branch\" = \"main\" ]; then\n        echo \"ğŸš€ è§¦å‘ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²...\"\n        \n        # å‘é€éƒ¨ç½²é€šçŸ¥\n        curl -X POST \"$SLACK_WEBHOOK\" \\\n            -H 'Content-type: application/json' \\\n            --data '{\n                \"text\": \"ğŸš€ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å¼€å§‹\",\n                \"attachments\": [{\n                    \"color\": \"good\",\n                    \"fields\": [{\n                        \"title\": \"åˆ†æ”¯\",\n                        \"value\": \"'$branch'\",\n                        \"short\": true\n                    }, {\n                        \"title\": \"æäº¤\",\n                        \"value\": \"'$newrev'\",\n                        \"short\": true\n                    }]\n                }]\n            }'\n        \n        # æ‰§è¡Œéƒ¨ç½²è„šæœ¬\n        /opt/deploy/production-deploy.sh $newrev\n        \n    elif [ \"$branch\" = \"develop\" ]; then\n        echo \"ğŸ§ª è§¦å‘æµ‹è¯•ç¯å¢ƒéƒ¨ç½²...\"\n        /opt/deploy/staging-deploy.sh $newrev\n    fi\n    \n    # æ›´æ–°é¡¹ç›®ç»Ÿè®¡\n    echo \"ğŸ“Š æ›´æ–°é¡¹ç›®ç»Ÿè®¡...\"\n    /opt/scripts/update-stats.sh $branch $newrev\n    \n    # å‘é€é‚®ä»¶é€šçŸ¥\n    echo \"ğŸ“§ å‘é€é€šçŸ¥é‚®ä»¶...\"\n    git log --pretty=format:\"%h %s (%an)\" $oldrev..$newrev | \\\n        mail -s \"[$branch] æ–°æäº¤æ¨é€\" team@company.com\n        \ndone\n\necho \"âœ… post-receiveæ“ä½œå®Œæˆ\"\nexit 0"
  },
  "huskySetup": {
    "title": "Huskyå®‰è£…ä¸é…ç½®",
    "language": "bash",
    "code": "# å®‰è£…Husky\nnpm install --save-dev husky\n\n# åˆå§‹åŒ–Husky\nnpx husky install\n\n# æ·»åŠ åˆ°package.json\nnpm pkg set scripts.prepare=\"husky install\"\n\n# åˆ›å»ºpre-commit hook\nnpx husky add .husky/pre-commit \"npm run lint && npm run test\"\n\n# åˆ›å»ºcommit-msg hook\nnpx husky add .husky/commit-msg 'npx --no -- commitlint --edit \"$1\"'\n\n# package.jsoné…ç½®\n{\n  \"scripts\": {\n    \"prepare\": \"husky install\",\n    \"lint\": \"eslint src --ext .js,.jsx,.ts,.tsx\",\n    \"lint:fix\": \"eslint src --ext .js,.jsx,.ts,.tsx --fix\",\n    \"format\": \"prettier --write src/**/*.{js,jsx,ts,tsx,json,css,md}\",\n    \"format:check\": \"prettier --check src/**/*.{js,jsx,ts,tsx,json,css,md}\",\n    \"test\": \"jest\",\n    \"type-check\": \"tsc --noEmit\"\n  },\n  \"devDependencies\": {\n    \"husky\": \"^8.0.0\",\n    \"@commitlint/cli\": \"^17.0.0\",\n    \"@commitlint/config-conventional\": \"^17.0.0\",\n    \"lint-staged\": \"^13.0.0\"\n  }\n}"
  },
  "lintStagedIntegration": {
    "title": "lint-stagedé›†æˆ",
    "language": "bash",
    "code": "# å®‰è£…lint-staged\nnpm install --save-dev lint-staged\n\n# .husky/pre-commit\n#!/usr/bin/env sh\n. \"$(dirname -- \"$0\")/_/husky.sh\"\n\nnpx lint-staged\n\n# package.jsoné…ç½®\n{\n  \"lint-staged\": {\n    \"*.{js,jsx,ts,tsx}\": [\n      \"eslint --fix\",\n      \"prettier --write\",\n      \"git add\"\n    ],\n    \"*.{json,css,md}\": [\n      \"prettier --write\",\n      \"git add\"\n    ],\n    \"*.{js,jsx,ts,tsx}\": [\n      \"npm run test -- --findRelatedTests --passWithNoTests\"\n    ]\n  }\n}\n\n# commitlinté…ç½®\n# commitlint.config.js\nmodule.exports = {\n  extends: ['@commitlint/config-conventional'],\n  rules: {\n    'type-enum': [\n      2,\n      'always',\n      [\n        'feat',\n        'fix',\n        'docs',\n        'style',\n        'refactor',\n        'test',\n        'chore',\n        'perf',\n        'ci',\n        'build',\n        'revert'\n      ]\n    ],\n    'subject-max-length': [2, 'always', 50],\n    'body-max-line-length': [2, 'always', 72]\n  }\n}\n\n# é«˜çº§é…ç½®ç¤ºä¾‹\n# .husky/pre-commit\n#!/usr/bin/env sh\n. \"$(dirname -- \"$0\")/_/husky.sh\"\n\necho \"ğŸ” è¿è¡Œpre-commitæ£€æŸ¥...\"\n\n# æ£€æŸ¥åˆ†æ”¯åç§°\nbranch=$(git rev-parse --abbrev-ref HEAD)\nvalid_pattern=\"^(feature|bugfix|hotfix|release)\\/[a-z0-9-]+$\"\n\nif [[ \"$branch\" != \"main\" && \"$branch\" != \"develop\" && ! \"$branch\" =~ $valid_pattern ]]; then\n    echo \"âŒ åˆ†æ”¯åç§°ä¸ç¬¦åˆè§„èŒƒ: $branch\"\n    echo \"æ­£ç¡®æ ¼å¼: feature/xxx, bugfix/xxx, hotfix/xxx, release/xxx\"\n    exit 1\nfi\n\n# è¿è¡Œlint-staged\nnpx lint-staged\n\necho \"âœ… pre-commitæ£€æŸ¥å®Œæˆ\""
  }
}
