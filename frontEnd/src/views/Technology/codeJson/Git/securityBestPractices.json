{
  "environmentVariables": {
    "title": "ç¯å¢ƒå˜é‡ç®¡ç†",
    "language": "bash",
    "code": "# .envæ–‡ä»¶ç®¡ç†\n# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶\n# .env (æœ¬åœ°å¼€å‘)\nDATABASE_URL=postgresql://localhost:5432/myapp_dev\nAPI_KEY=dev-api-key-12345\nJWT_SECRET=dev-jwt-secret-67890\n\n# .env.production (ç”Ÿäº§ç¯å¢ƒ)\nDATABASE_URL=postgresql://prod-server:5432/myapp_prod\nAPI_KEY=prod-api-key-abcde\nJWT_SECRET=prod-jwt-secret-fghij\n\n# .gitignoreé…ç½®\n# ç¯å¢ƒå˜é‡æ–‡ä»¶\n.env\n.env.local\n.env.development\n.env.production\n.env.test\n\n# é…ç½®æ–‡ä»¶\nconfig/database.yml\nconfig/secrets.yml\n*.pem\n*.key\n*.p12\n\n# æ—¥å¿—æ–‡ä»¶\n*.log\nlogs/\n\n# ä¸´æ—¶æ–‡ä»¶\ntmp/\ntemp/\n.cache/\n\n# IDEé…ç½®\n.vscode/settings.json\n.idea/\n\n# æ“ä½œç³»ç»Ÿæ–‡ä»¶\n.DS_Store\nThumbs.db\n\n# åº”ç”¨ä»£ç ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡\n// Node.js\nconst config = {\n    database: {\n        url: process.env.DATABASE_URL,\n        ssl: process.env.NODE_ENV === 'production'\n    },\n    api: {\n        key: process.env.API_KEY,\n        secret: process.env.API_SECRET\n    },\n    jwt: {\n        secret: process.env.JWT_SECRET,\n        expiresIn: process.env.JWT_EXPIRES_IN || '24h'\n    }\n}\n\n// React\nconst config = {\n    apiUrl: process.env.REACT_APP_API_URL,\n    environment: process.env.NODE_ENV\n}\n\n// ç¯å¢ƒå˜é‡éªŒè¯\nconst requiredEnvVars = [\n    'DATABASE_URL',\n    'API_KEY', \n    'JWT_SECRET'\n]\n\nrequiredEnvVars.forEach(envVar => {\n    if (!process.env[envVar]) {\n        throw new Error(`Missing required environment variable: ${envVar}`)\n    }\n})"
  },
  "gitSecrets": {
    "title": "Git Secretså·¥å…·",
    "language": "bash",
    "code": "# å®‰è£…git-secrets\n# macOS\nbrew install git-secrets\n\n# Ubuntu/Debian\nsudo apt-get install git-secrets\n\n# åˆå§‹åŒ–git-secrets\ngit secrets --install\ngit secrets --register-aws\n\n# æ·»åŠ è‡ªå®šä¹‰è§„åˆ™\n# æ£€æµ‹APIå¯†é’¥\ngit secrets --add 'api[_-]?key[_-]?[=:][\"']?[a-zA-Z0-9]{20,}'\n\n# æ£€æµ‹JWTä»¤ç‰Œ\ngit secrets --add 'jwt[_-]?token[_-]?[=:][\"']?[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=]+\\.?[A-Za-z0-9-_.+/=]*'\n\n# æ£€æµ‹æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²\ngit secrets --add 'postgresql://[^\\s]+'\ngit secrets --add 'mysql://[^\\s]+'\ngit secrets --add 'mongodb://[^\\s]+'\n\n# æ£€æµ‹ç§é’¥\ngit secrets --add '-----BEGIN [A-Z]+ PRIVATE KEY-----'\n\n# æ£€æµ‹å¯†ç å­—æ®µ\ngit secrets --add 'password[_-]?[=:][\"']?[^\\s\"'][^\\s\"']+'\n\n# å…¨å±€é…ç½®\ngit secrets --install ~/.git-templates/git-secrets\ngit config --global init.templateDir ~/.git-templates/git-secrets\n\n# æ‰«æç°æœ‰ä»“åº“\ngit secrets --scan\n\n# æ‰«æå†å²è®°å½•\ngit secrets --scan-history\n\n# åœ¨CI/CDä¸­ä½¿ç”¨\n# .github/workflows/security.yml\nname: Security Scan\non: [push, pull_request]\n\njobs:\n  secrets-scan:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n        with:\n          fetch-depth: 0\n      \n      - name: Install git-secrets\n        run: |\n          git clone https://github.com/awslabs/git-secrets.git\n          cd git-secrets && sudo make install\n      \n      - name: Configure git-secrets\n        run: |\n          git secrets --register-aws\n          git secrets --install\n      \n      - name: Scan for secrets\n        run: git secrets --scan-history"
  },
  "sensitiveDataCleanup": {
    "title": "æ•æ„Ÿä¿¡æ¯æ¸…ç†",
    "language": "bash",
    "code": "# ä½¿ç”¨BFG Repo-Cleaneræ¸…ç†å†å²\n# ä¸‹è½½BFG\nwget https://repo1.maven.org/maven2/com/madgag/bfg/1.14.0/bfg-1.14.0.jar\n\n# åˆ é™¤åŒ…å«å¯†ç çš„æ–‡ä»¶\njava -jar bfg.jar --delete-files passwords.txt\n\n# æ›¿æ¢æ•æ„Ÿå­—ç¬¦ä¸²\njava -jar bfg.jar --replace-text replacements.txt\n\n# replacements.txtå†…å®¹ç¤ºä¾‹\napi_key_12345==>[REMOVED]\npassword123==>[REMOVED]\nsecret_token_xyz==>[REMOVED]\n\n# æ¸…ç†.gitç›®å½•\ngit reflog expire --expire=now --all\ngit gc --prune=now --aggressive\n\n# ä½¿ç”¨git filter-branch (è¾ƒæ…¢ä½†æ›´ç²¾ç¡®)\n# åˆ é™¤ç‰¹å®šæ–‡ä»¶\ngit filter-branch --force --index-filter \\\n  'git rm --cached --ignore-unmatch config/secrets.yml' \\\n  --prune-empty --tag-name-filter cat -- --all\n\n# æ›¿æ¢æ•æ„Ÿå†…å®¹\ngit filter-branch --force --tree-filter \\\n  'find . -name \"*.js\" -exec sed -i \"s/api_key_12345/[REMOVED]/g\" {} \\;' \\\n  --prune-empty --tag-name-filter cat -- --all\n\n# å¼ºåˆ¶æ¨é€æ¸…ç†åçš„å†å² (å±é™©æ“ä½œ!)\ngit push origin --force --all\ngit push origin --force --tags\n\n# é€šçŸ¥å›¢é˜Ÿæˆå‘˜é‡æ–°å…‹éš†ä»“åº“\necho \"è­¦å‘Š: ä»“åº“å†å²å·²è¢«é‡å†™ï¼Œè¯·é‡æ–°å…‹éš†ä»“åº“\"\n\n# é¢„é˜²æªæ–½è„šæœ¬\n#!/bin/bash\n# pre-commit-security-check.sh\n\n# æ£€æŸ¥å¸¸è§æ•æ„Ÿä¿¡æ¯æ¨¡å¼\nPATTERNS=(\n    \"password[\\\\s]*[=:]\"\n    \"api[_-]?key[\\\\s]*[=:]\"\n    \"secret[\\\\s]*[=:]\"\n    \"token[\\\\s]*[=:]\"\n    \"-----BEGIN.*PRIVATE KEY-----\"\n    \"postgresql://.*:.*@\"\n    \"mysql://.*:.*@\"\n)\n\nfor pattern in \"${PATTERNS[@]}\"; do\n    if git diff --cached | grep -iE \"$pattern\"; then\n        echo \"âŒ æ£€æµ‹åˆ°å¯èƒ½çš„æ•æ„Ÿä¿¡æ¯: $pattern\"\n        echo \"è¯·æ£€æŸ¥å¹¶ç§»é™¤æ•æ„Ÿä¿¡æ¯åå†æäº¤\"\n        exit 1\n    fi\ndone\n\necho \"âœ… å®‰å…¨æ£€æŸ¥é€šè¿‡\""
  },
  "gpgSigning": {
    "title": "GPGç­¾åé…ç½®",
    "language": "bash",
    "code": "# ç”ŸæˆGPGå¯†é’¥\ngpg --full-generate-key\n\n# é€‰æ‹©å¯†é’¥ç±»å‹ (æ¨èRSA 4096ä½)\n# è®¾ç½®æœ‰æ•ˆæœŸ (æ¨è1-2å¹´)\n# è¾“å…¥ç”¨æˆ·ä¿¡æ¯ (ä¸Gité…ç½®ä¸€è‡´)\n\n# åˆ—å‡ºGPGå¯†é’¥\ngpg --list-secret-keys --keyid-format LONG\n\n# è¾“å‡ºç¤ºä¾‹:\n# sec   rsa4096/ABC123DEF456 2023-01-01 [SC] [expires: 2025-01-01]\n# uid                 [ultimate] Your Name <your.email@example.com>\n# ssb   rsa4096/XYZ789ABC123 2023-01-01 [E] [expires: 2025-01-01]\n\n# é…ç½®Gitä½¿ç”¨GPGç­¾å\ngit config --global user.signingkey ABC123DEF456\ngit config --global commit.gpgsign true\ngit config --global tag.gpgsign true\n\n# å¯¼å‡ºå…¬é’¥æ·»åŠ åˆ°GitHub\ngpg --armor --export ABC123DEF456\n\n# é…ç½®GPGç¨‹åºè·¯å¾„ (å¦‚æœéœ€è¦)\ngit config --global gpg.program gpg\n\n# ç­¾åæäº¤\ngit commit -S -m \"Signed commit message\"\n\n# éªŒè¯ç­¾å\ngit log --show-signature\n\n# æ‰¹é‡ç­¾åå†å²æäº¤ (è°¨æ…ä½¿ç”¨)\ngit rebase --exec 'git commit --amend --no-edit -S' -i HEAD~10\n\n# GPGå¯†é’¥ç®¡ç†\n# å¤‡ä»½å¯†é’¥\ngpg --export-secret-keys ABC123DEF456 > private-key-backup.asc\ngpg --export ABC123DEF456 > public-key-backup.asc\n\n# æ¢å¤å¯†é’¥\ngpg --import private-key-backup.asc\ngpg --import public-key-backup.asc\n\n# æ’¤é”€å¯†é’¥\ngpg --gen-revoke ABC123DEF456 > revocation-certificate.asc\n\n# å¯†é’¥æœåŠ¡å™¨æ“ä½œ\n# ä¸Šä¼ å…¬é’¥åˆ°å¯†é’¥æœåŠ¡å™¨\ngpg --keyserver keyserver.ubuntu.com --send-keys ABC123DEF456\n\n# ä»å¯†é’¥æœåŠ¡å™¨è·å–å…¬é’¥\ngpg --keyserver keyserver.ubuntu.com --recv-keys ABC123DEF456\n\n# è‡ªåŠ¨åŒ–ç­¾åè„šæœ¬\n#!/bin/bash\n# setup-gpg-signing.sh\n\necho \"ğŸ” é…ç½®GPGç­¾å...\"\n\n# æ£€æŸ¥æ˜¯å¦å·²æœ‰GPGå¯†é’¥\nif ! gpg --list-secret-keys | grep -q \"sec\"; then\n    echo \"æœªæ‰¾åˆ°GPGå¯†é’¥ï¼Œè¯·å…ˆç”Ÿæˆå¯†é’¥:\"\n    echo \"gpg --full-generate-key\"\n    exit 1\nfi\n\n# è·å–å¯†é’¥ID\nKEY_ID=$(gpg --list-secret-keys --keyid-format LONG | grep \"sec\" | head -1 | sed 's/.*\\/\\([A-F0-9]\\{16\\}\\).*/\\1/')\n\nif [ -z \"$KEY_ID\" ]; then\n    echo \"âŒ æ— æ³•è·å–GPGå¯†é’¥ID\"\n    exit 1\nfi\n\necho \"æ‰¾åˆ°GPGå¯†é’¥: $KEY_ID\"\n\n# é…ç½®Git\ngit config --global user.signingkey \"$KEY_ID\"\ngit config --global commit.gpgsign true\ngit config --global tag.gpgsign true\n\necho \"âœ… GPGç­¾åé…ç½®å®Œæˆ\"\necho \"å…¬é’¥å†…å®¹ (æ·»åŠ åˆ°GitHub):\"\ngpg --armor --export \"$KEY_ID\""
  },
  "sshKeyManagement": {
    "title": "SSHå¯†é’¥ç®¡ç†",
    "language": "bash",
    "code": "# ç”ŸæˆSSHå¯†é’¥\n# ED25519å¯†é’¥ (æ¨è)\nssh-keygen -t ed25519 -C \"your.email@example.com\" -f ~/.ssh/id_ed25519\n\n# RSAå¯†é’¥ (å…¼å®¹æ€§æ›´å¥½)\nssh-keygen -t rsa -b 4096 -C \"your.email@example.com\" -f ~/.ssh/id_rsa\n\n# é…ç½®SSHå¯†é’¥æƒé™\nchmod 700 ~/.ssh\nchmod 600 ~/.ssh/id_ed25519\nchmod 644 ~/.ssh/id_ed25519.pub\n\n# SSHé…ç½®æ–‡ä»¶\n# ~/.ssh/config\nHost github.com\n    HostName github.com\n    User git\n    IdentityFile ~/.ssh/id_ed25519\n    IdentitiesOnly yes\n\nHost gitlab.com\n    HostName gitlab.com\n    User git\n    IdentityFile ~/.ssh/id_rsa\n    IdentitiesOnly yes\n\n# å¤šè´¦æˆ·é…ç½®\nHost github-work\n    HostName github.com\n    User git\n    IdentityFile ~/.ssh/id_work\n    IdentitiesOnly yes\n\nHost github-personal\n    HostName github.com\n    User git\n    IdentityFile ~/.ssh/id_personal\n    IdentitiesOnly yes\n\n# ä½¿ç”¨ä¸åŒè´¦æˆ·\ngit clone git@github-work:company/repo.git\ngit clone git@github-personal:username/repo.git\n\n# SSH Agenté…ç½®\n# å¯åŠ¨SSH Agent\neval \"$(ssh-agent -s)\"\n\n# æ·»åŠ å¯†é’¥åˆ°SSH Agent\nssh-add ~/.ssh/id_ed25519\n\n# æŒä¹…åŒ–SSH Agent (macOS)\n# ~/.ssh/config\nHost *\n    AddKeysToAgent yes\n    UseKeychain yes\n    IdentityFile ~/.ssh/id_ed25519\n\n# æµ‹è¯•SSHè¿æ¥\nssh -T git@github.com\n\n# SSHå¯†é’¥è½®æ¢è„šæœ¬\n#!/bin/bash\n# rotate-ssh-keys.sh\n\nOLD_KEY=\"$1\"\nNEW_KEY=\"$2\"\n\nif [ -z \"$OLD_KEY\" ] || [ -z \"$NEW_KEY\" ]; then\n    echo \"ç”¨æ³•: $0 <old_key_path> <new_key_path>\"\n    exit 1\nfi\n\necho \"ğŸ”„ è½®æ¢SSHå¯†é’¥...\"\n\n# ç”Ÿæˆæ–°å¯†é’¥\nssh-keygen -t ed25519 -C \"rotated-key-$(date +%Y%m%d)\" -f \"$NEW_KEY\"\n\necho \"âœ… æ–°å¯†é’¥å·²ç”Ÿæˆ: $NEW_KEY\"\necho \"ğŸ“‹ è¯·å°†ä»¥ä¸‹å…¬é’¥æ·»åŠ åˆ°GitHub:\"\ncat \"$NEW_KEY.pub\"\n\nread -p \"æ·»åŠ å®ŒæˆåæŒ‰Enterç»§ç»­...\"\n\n# æµ‹è¯•æ–°å¯†é’¥\nssh -i \"$NEW_KEY\" -T git@github.com\n\nif [ $? -eq 1 ]; then\n    echo \"âœ… æ–°å¯†é’¥æµ‹è¯•æˆåŠŸ\"\n    echo \"ğŸ—‘ï¸  è¯·æ‰‹åŠ¨åˆ é™¤æ—§å¯†é’¥: $OLD_KEY\"\nelse\n    echo \"âŒ æ–°å¯†é’¥æµ‹è¯•å¤±è´¥\"\n    exit 1\nfi"
  },
  "githubPermissions": {
    "title": "GitHubæƒé™ç®¡ç†",
    "language": "bash",
    "code": "# ä»“åº“æƒé™çº§åˆ«\n# Read: å…‹éš†å’Œæ‹‰å–\n# Triage: Read + ç®¡ç†issueså’ŒPR\n# Write: Triage + æ¨é€åˆ°éä¿æŠ¤åˆ†æ”¯\n# Maintain: Write + ç®¡ç†ä»“åº“è®¾ç½®\n# Admin: å®Œå…¨æ§åˆ¶æƒé™\n\n# åˆ†æ”¯ä¿æŠ¤è§„åˆ™\n# é€šè¿‡GitHub Webç•Œé¢æˆ–APIé…ç½®\n{\n  \"required_status_checks\": {\n    \"strict\": true,\n    \"contexts\": [\"ci/tests\", \"ci/lint\"]\n  },\n  \"enforce_admins\": true,\n  \"required_pull_request_reviews\": {\n    \"required_approving_review_count\": 2,\n    \"dismiss_stale_reviews\": true,\n    \"require_code_owner_reviews\": true,\n    \"restrict_pushes\": true\n  },\n  \"restrictions\": {\n    \"users\": [\"admin-user\"],\n    \"teams\": [\"core-team\"]\n  }\n}\n\n# CODEOWNERSæ–‡ä»¶\n# .github/CODEOWNERS\n# å…¨å±€æ‰€æœ‰è€…\n* @team-leads\n\n# å‰ç«¯ä»£ç \n/frontend/ @frontend-team\n*.js @frontend-team\n*.jsx @frontend-team\n*.ts @frontend-team\n*.tsx @frontend-team\n\n# åç«¯ä»£ç \n/backend/ @backend-team\n*.py @backend-team\n*.java @backend-team\n\n# åŸºç¡€è®¾æ–½\n/docker/ @devops-team\n/k8s/ @devops-team\nDockerfile @devops-team\n\n# æ–‡æ¡£\n/docs/ @tech-writers\n*.md @tech-writers\n\n# é…ç½®æ–‡ä»¶\n/.github/ @admin-team\n/config/ @admin-team\n\n# å›¢é˜Ÿç®¡ç†\n# åˆ›å»ºå›¢é˜Ÿ\ncurl -X POST \\\n  https://api.github.com/orgs/ORG/teams \\\n  -H \"Authorization: token $GITHUB_TOKEN\" \\\n  -d '{\n    \"name\": \"frontend-team\",\n    \"description\": \"Frontend development team\",\n    \"privacy\": \"closed\",\n    \"permission\": \"push\"\n  }'\n\n# æ·»åŠ å›¢é˜Ÿæˆå‘˜\ncurl -X PUT \\\n  https://api.github.com/orgs/ORG/teams/TEAM/memberships/USERNAME \\\n  -H \"Authorization: token $GITHUB_TOKEN\" \\\n  -d '{\"role\": \"member\"}'\n\n# è®¾ç½®ä»“åº“æƒé™\ncurl -X PUT \\\n  https://api.github.com/orgs/ORG/teams/TEAM/repos/ORG/REPO \\\n  -H \"Authorization: token $GITHUB_TOKEN\" \\\n  -d '{\"permission\": \"push\"}'\n\n# æƒé™å®¡è®¡è„šæœ¬\n#!/bin/bash\n# audit-permissions.sh\n\nORG=\"your-org\"\nTOKEN=\"$GITHUB_TOKEN\"\n\necho \"ğŸ“Š GitHubæƒé™å®¡è®¡æŠ¥å‘Š\"\necho \"ç»„ç»‡: $ORG\"\necho \"æ—¶é—´: $(date)\"\necho \"==========================\"\n\n# è·å–æ‰€æœ‰ä»“åº“\nrepos=$(curl -s -H \"Authorization: token $TOKEN\" \\\n  \"https://api.github.com/orgs/$ORG/repos?per_page=100\" | \\\n  jq -r '.[].name')\n\nfor repo in $repos; do\n    echo \"\\nğŸ“ ä»“åº“: $repo\"\n    \n    # è·å–åä½œè€…\n    collaborators=$(curl -s -H \"Authorization: token $TOKEN\" \\\n      \"https://api.github.com/repos/$ORG/$repo/collaborators\" | \\\n      jq -r '.[] | \"\\(.login) (\\(.permissions.admin // false | if . then \"admin\" else if .permissions.push then \"write\" else \"read\" end end))\"')\n    \n    echo \"ğŸ‘¥ åä½œè€…:\"\n    echo \"$collaborators\"\n    \n    # æ£€æŸ¥åˆ†æ”¯ä¿æŠ¤\n    protection=$(curl -s -H \"Authorization: token $TOKEN\" \\\n      \"https://api.github.com/repos/$ORG/$repo/branches/main/protection\" 2>/dev/null)\n    \n    if [ \"$protection\" != \"null\" ]; then\n        echo \"ğŸ›¡ï¸  ä¸»åˆ†æ”¯å·²ä¿æŠ¤\"\n    else\n        echo \"âš ï¸  ä¸»åˆ†æ”¯æœªä¿æŠ¤\"\n    fi\ndone"
  },
  "accessTokenManagement": {
    "title": "è®¿é—®ä»¤ç‰Œç®¡ç†",
    "language": "bash",
    "code": "# Personal Access Token (PAT) æœ€ä½³å®è·µ\n\n# 1. æœ€å°æƒé™åŸåˆ™\n# åªæˆäºˆå¿…è¦çš„æƒé™èŒƒå›´\n# å¸¸ç”¨æƒé™èŒƒå›´:\n# - repo: å®Œæ•´ä»“åº“è®¿é—®\n# - public_repo: å…¬å…±ä»“åº“è®¿é—®\n# - read:org: è¯»å–ç»„ç»‡ä¿¡æ¯\n# - workflow: GitHub Actionsè®¿é—®\n\n# 2. ä»¤ç‰Œè½®æ¢\n# å®šæœŸæ›´æ¢è®¿é—®ä»¤ç‰Œ (å»ºè®®3-6ä¸ªæœˆ)\n\n# 3. ç¯å¢ƒéš”ç¦»\n# å¼€å‘ç¯å¢ƒä»¤ç‰Œ\nGITHUB_TOKEN_DEV=ghp_xxxxxxxxxxxxxxxxxxxx\n\n# ç”Ÿäº§ç¯å¢ƒä»¤ç‰Œ\nGITHUB_TOKEN_PROD=ghp_yyyyyyyyyyyyyyyyyyyy\n\n# CI/CDç¯å¢ƒä»¤ç‰Œ\nGITHUB_TOKEN_CI=ghp_zzzzzzzzzzzzzzzzzzzz\n\n# 4. ä»¤ç‰Œå­˜å‚¨\n# ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡\n# AWS Secrets Manager\naws secretsmanager create-secret \\\n  --name \"github-token\" \\\n  --description \"GitHub Personal Access Token\" \\\n  --secret-string \"$GITHUB_TOKEN\"\n\n# Azure Key Vault\naz keyvault secret set \\\n  --vault-name \"MyKeyVault\" \\\n  --name \"github-token\" \\\n  --value \"$GITHUB_TOKEN\"\n\n# 5. ä»¤ç‰Œç›‘æ§\n# ç›‘æ§ä»¤ç‰Œä½¿ç”¨æƒ…å†µ\ncurl -H \"Authorization: token $GITHUB_TOKEN\" \\\n  https://api.github.com/user\n\n# æ£€æŸ¥ä»¤ç‰Œæƒé™\ncurl -H \"Authorization: token $GITHUB_TOKEN\" \\\n  https://api.github.com/user/repos\n\n# 6. è‡ªåŠ¨åŒ–ä»¤ç‰Œç®¡ç†\n#!/bin/bash\n# token-rotation.sh\n\nOLD_TOKEN=\"$1\"\nNEW_TOKEN=\"$2\"\n\nif [ -z \"$OLD_TOKEN\" ] || [ -z \"$NEW_TOKEN\" ]; then\n    echo \"ç”¨æ³•: $0 <old_token> <new_token>\"\n    exit 1\nfi\n\necho \"ğŸ”„ å¼€å§‹ä»¤ç‰Œè½®æ¢...\"\n\n# æµ‹è¯•æ–°ä»¤ç‰Œ\nif curl -s -H \"Authorization: token $NEW_TOKEN\" \\\n   https://api.github.com/user > /dev/null; then\n    echo \"âœ… æ–°ä»¤ç‰ŒéªŒè¯æˆåŠŸ\"\nelse\n    echo \"âŒ æ–°ä»¤ç‰ŒéªŒè¯å¤±è´¥\"\n    exit 1\nfi\n\n# æ›´æ–°ç¯å¢ƒå˜é‡\necho \"ğŸ“ è¯·æ›´æ–°ä»¥ä¸‹ä½ç½®çš„ä»¤ç‰Œ:\"\necho \"- CI/CDç³»ç»Ÿç¯å¢ƒå˜é‡\"\necho \"- å¯†é’¥ç®¡ç†æœåŠ¡\"\necho \"- æœ¬åœ°å¼€å‘ç¯å¢ƒ\"\necho \"- éƒ¨ç½²è„šæœ¬\"\n\n# éªŒè¯æ—§ä»¤ç‰Œæ˜¯å¦ä»ç„¶æœ‰æ•ˆ\nif curl -s -H \"Authorization: token $OLD_TOKEN\" \\\n   https://api.github.com/user > /dev/null; then\n    echo \"âš ï¸  æ—§ä»¤ç‰Œä»ç„¶æœ‰æ•ˆï¼Œè¯·åœ¨GitHubè®¾ç½®ä¸­æ’¤é”€\"\nelse\n    echo \"âœ… æ—§ä»¤ç‰Œå·²å¤±æ•ˆ\"\nfi\n\n# GitHub Appè®¤è¯ (æ¨èç”¨äºç»„ç»‡)\n# ç”ŸæˆJWTä»¤ç‰Œ\ngenerate_jwt() {\n    local app_id=\"$1\"\n    local private_key_path=\"$2\"\n    \n    # JWTå¤´éƒ¨\n    header='{\"alg\":\"RS256\",\"typ\":\"JWT\"}'\n    \n    # JWTè½½è·\n    now=$(date +%s)\n    exp=$(($now + 600)) # 10åˆ†é’Ÿè¿‡æœŸ\n    payload='{\"iat\":'$now',\"exp\":'$exp',\"iss\":'$app_id'}'\n    \n    # ç”ŸæˆJWT\n    jwt=$(echo -n \"$header\" | base64 -w 0 | tr -d '=' | tr '/+' '_-')\n    jwt=\"$jwt.\"$(echo -n \"$payload\" | base64 -w 0 | tr -d '=' | tr '/+' '_-')\n    \n    signature=$(echo -n \"$jwt\" | openssl dgst -sha256 -sign \"$private_key_path\" | base64 -w 0 | tr -d '=' | tr '/+' '_-')\n    \n    echo \"$jwt.$signature\"\n}\n\n# è·å–å®‰è£…è®¿é—®ä»¤ç‰Œ\nget_installation_token() {\n    local jwt=\"$1\"\n    local installation_id=\"$2\"\n    \n    curl -X POST \\\n      -H \"Authorization: Bearer $jwt\" \\\n      -H \"Accept: application/vnd.github.v3+json\" \\\n      \"https://api.github.com/app/installations/$installation_id/access_tokens\" | \\\n      jq -r '.token'\n}"
  }
}