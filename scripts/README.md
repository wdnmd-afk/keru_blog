# å›½é™…åŒ–è‡ªåŠ¨åŒ–å·¥å…·é›†

## æ¦‚è¿°

è¿™æ˜¯ä¸€å¥—å®Œæ•´çš„Reacté¡¹ç›®å›½é™…åŒ–è‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ—¨åœ¨è§£å†³å¤§å‹é¡¹ç›®ä¸­æ‰‹åŠ¨å›½é™…åŒ–æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚

## å·¥å…·ç‰¹æ€§

### ğŸ” æ™ºèƒ½æ‰«æ (i18n-scanner.js)
- è‡ªåŠ¨è¯†åˆ«é¡¹ç›®ä¸­çš„ç¡¬ç¼–ç ä¸­æ–‡æ–‡æœ¬
- æ”¯æŒJSXã€å­—ç¬¦ä¸²å­—é¢é‡ã€æ¨¡æ¿å­—ç¬¦ä¸²ç­‰å¤šç§æ ¼å¼
- æ™ºèƒ½ç”Ÿæˆç¿»è¯‘é”®å»ºè®®
- æŒ‰å‘½åç©ºé—´ç»„ç»‡ç¿»è¯‘å†…å®¹

### ğŸ”„ è‡ªåŠ¨æ›¿æ¢ (i18n-replacer.js)
- åŸºäºASTçš„ç²¾ç¡®ä»£ç æ›¿æ¢
- è‡ªåŠ¨æ·»åŠ useTranslation hook
- æ™ºèƒ½å¤„ç†JSXå’Œå­—ç¬¦ä¸²æ–‡æœ¬
- æ”¯æŒé¢„è§ˆæ¨¡å¼å’Œå›æ»šåŠŸèƒ½

### âœ… è´¨é‡éªŒè¯ (i18n-validator.js)
- æ£€æµ‹é—æ¼çš„å›½é™…åŒ–æ–‡æœ¬
- éªŒè¯ç¿»è¯‘é”®å®Œæ•´æ€§
- è¯†åˆ«æœªä½¿ç”¨çš„ç¿»è¯‘é”®
- ç”Ÿæˆè¯¦ç»†çš„è´¨é‡æŠ¥å‘Š

### ğŸš€ ä¸€é”®å·¥ä½œæµ (i18n-workflow.js)
- é›†æˆæ‰€æœ‰å·¥å…·çš„å®Œæ•´æµç¨‹
- äº¤äº’å¼æ“ä½œç•Œé¢
- æ”¯æŒå¢é‡æ›´æ–°
- è‡ªåŠ¨ç”Ÿæˆå·¥ä½œæ€»ç»“

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
cd scripts
npm install
```

### 2. è¿è¡Œå®Œæ•´å·¥ä½œæµ
```bash
# äº¤äº’å¼æ¨¡å¼
npm run workflow

# è‡ªåŠ¨æ¨¡å¼
npm run workflow:auto
```

### 3. å•ç‹¬ä½¿ç”¨å·¥å…·
```bash
# æ‰«æç¡¬ç¼–ç æ–‡æœ¬
npm run scan

# æ‰§è¡Œè‡ªåŠ¨æ›¿æ¢
npm run replace scan-report.json

# éªŒè¯å›½é™…åŒ–è´¨é‡
npm run validate
```

## è¯¦ç»†ä½¿ç”¨è¯´æ˜

### æ‰«æå·¥å…· (i18n-scanner.js)

**åŠŸèƒ½**: æ‰«æé¡¹ç›®ä¸­çš„ç¡¬ç¼–ç æ–‡æœ¬å¹¶ç”Ÿæˆæ›¿æ¢å»ºè®®

**ä½¿ç”¨æ–¹æ³•**:
```bash
node i18n-scanner.js [æºç ç›®å½•] [è¾“å‡ºç›®å½•]
```

**è¾“å‡ºæ–‡ä»¶**:
- `scan-report.json`: è¯¦ç»†çš„æ‰«æç»“æœ
- `scan-report.md`: äººç±»å¯è¯»çš„æŠ¥å‘Š
- `replacement-script.js`: æ‰¹é‡æ›¿æ¢è„šæœ¬

**é…ç½®é€‰é¡¹**:
```javascript
const scanner = new I18nScanner({
    srcDir: 'frontEnd/src',           // æºç ç›®å½•
    outputDir: 'scripts/i18n-output', // è¾“å‡ºç›®å½•
    extensions: ['.tsx', '.ts'],       // æ–‡ä»¶æ‰©å±•å
    excludePatterns: ['**/test/**']    // æ’é™¤æ¨¡å¼
});
```

### æ›¿æ¢å·¥å…· (i18n-replacer.js)

**åŠŸèƒ½**: åŸºäºæ‰«æç»“æœè‡ªåŠ¨æ›¿æ¢ç¡¬ç¼–ç æ–‡æœ¬

**ä½¿ç”¨æ–¹æ³•**:
```bash
node i18n-replacer.js scan-report.json [--dry-run]
```

**ä¸»è¦ç‰¹æ€§**:
- åŸºäºBabel ASTçš„ç²¾ç¡®æ›¿æ¢
- è‡ªåŠ¨æ·»åŠ importå’ŒuseTranslation
- æ”¯æŒJSXè¡¨è¾¾å¼å’Œå­—ç¬¦ä¸²å­—é¢é‡
- é¢„è§ˆæ¨¡å¼é¿å…è¯¯æ“ä½œ

### éªŒè¯å·¥å…· (i18n-validator.js)

**åŠŸèƒ½**: æ£€æµ‹å›½é™…åŒ–å®ç°çš„è´¨é‡é—®é¢˜

**ä½¿ç”¨æ–¹æ³•**:
```bash
node i18n-validator.js
```

**æ£€æµ‹å†…å®¹**:
- é—æ¼çš„å›½é™…åŒ–æ–‡æœ¬
- ç¼ºå¤±çš„ç¿»è¯‘
- æœªä½¿ç”¨çš„ç¿»è¯‘é”®
- TODOæ ‡è®°çš„ç¿»è¯‘

### å·¥ä½œæµå·¥å…· (i18n-workflow.js)

**åŠŸèƒ½**: ä¸€é”®æ‰§è¡Œå®Œæ•´çš„å›½é™…åŒ–æµç¨‹

**ä½¿ç”¨æ–¹æ³•**:
```bash
# äº¤äº’å¼æ¨¡å¼
node i18n-workflow.js

# è‡ªåŠ¨æ¨¡å¼
node i18n-workflow.js --no-interactive

# æŒ‡å®šæºç ç›®å½•
node i18n-workflow.js --src=src/components
```

**å·¥ä½œæµæ­¥éª¤**:
1. æ‰«æç¡¬ç¼–ç æ–‡æœ¬
2. é¢„è§ˆæ‰«æç»“æœ
3. æ‰§è¡Œè‡ªåŠ¨æ›¿æ¢
4. éªŒè¯å›½é™…åŒ–è´¨é‡
5. ç”Ÿæˆå·¥ä½œæ€»ç»“

## æœ€ä½³å®è·µ

### 1. é¡¹ç›®åˆå§‹åŒ–
```bash
# é¦–æ¬¡è¿è¡Œå®Œæ•´å·¥ä½œæµ
npm run workflow

# æ£€æŸ¥ç”Ÿæˆçš„æŠ¥å‘Š
ls scripts/i18n-output/
```

### 2. å¢é‡æ›´æ–°
```bash
# åªæ‰«ææ–°å¢æ–‡ä»¶
node i18n-scanner.js src/new-feature

# éªŒè¯ç°æœ‰å›½é™…åŒ–
npm run validate
```

### 3. CI/CDé›†æˆ
```bash
# åœ¨CIä¸­æ£€æŸ¥å›½é™…åŒ–è´¨é‡
npm run validate
if [ $? -ne 0 ]; then
  echo "å›½é™…åŒ–æ£€æŸ¥å¤±è´¥"
  exit 1
fi
```

### 4. å›¢é˜Ÿåä½œ
- å®šæœŸè¿è¡ŒéªŒè¯å·¥å…·æ£€æŸ¥è´¨é‡
- æ–°åŠŸèƒ½å¼€å‘ååŠæ—¶è¿è¡Œæ‰«æ
- ç¿»è¯‘æ–‡ä»¶å˜æ›´éœ€è¦code review
- å»ºç«‹å›½é™…åŒ–å¼€å‘è§„èŒƒ

## é…ç½®æ–‡ä»¶

### .i18nrc.json (å¯é€‰)
```json
{
  "srcDir": "src",
  "i18nDir": "src/i18n/locales",
  "languages": ["zh", "en", "ja"],
  "namespaces": ["common", "layout", "feature"],
  "excludePatterns": [
    "**/test/**",
    "**/stories/**"
  ],
  "keyNaming": {
    "maxLength": 50,
    "separator": "_",
    "caseStyle": "snake_case"
  }
}
```

## æ•…éšœæ’é™¤

### è·¯å¾„é…ç½®é—®é¢˜

**Q: è¿è¡Œ `pnpm scan` æ˜¾ç¤ºæ‰¾åˆ° 0 ä¸ªæ–‡ä»¶**
A: è¿™æ˜¯æœ€å¸¸è§çš„é—®é¢˜ï¼Œé€šå¸¸æ˜¯è·¯å¾„é…ç½®é”™è¯¯å¯¼è‡´çš„

**è§£å†³æ­¥éª¤:**
```bash
# 1. è¿è¡Œè¯Šæ–­å·¥å…·
npm run diagnostic

# 2. è¿è¡Œå¿«é€Ÿä¿®å¤
npm run quick-fix

# 3. é‡æ–°æµ‹è¯•æ‰«æ
npm run test-scan
```

**æ‰‹åŠ¨ä¿®å¤:**
1. æ£€æŸ¥å‰ç«¯æºç ç›®å½•ä½ç½®ï¼ˆé€šå¸¸æ˜¯ `../frontEnd/src`ï¼‰
2. ä¿®æ”¹ `i18n-scanner.js` ä¸­çš„ `srcDir` é…ç½®
3. ç¡®è®¤æ–‡ä»¶æ‰©å±•åé…ç½®åŒ…å«é¡¹ç›®ä½¿ç”¨çš„ç±»å‹

### å¸¸è§é—®é¢˜

**Q: æ‰«æç»“æœåŒ…å«ä¸éœ€è¦å›½é™…åŒ–çš„æ–‡æœ¬**
A: åœ¨scannerä¸­æ·»åŠ æ›´å¤šè¿‡æ»¤æ¡ä»¶ï¼Œæˆ–ä½¿ç”¨excludePatternsæ’é™¤ç‰¹å®šæ–‡ä»¶

**Q: è‡ªåŠ¨æ›¿æ¢åä»£ç æ— æ³•ç¼–è¯‘**
A: æ£€æŸ¥æ˜¯å¦æ­£ç¡®æ·»åŠ äº†useTranslation hookï¼Œç¡®è®¤ç¿»è¯‘é”®æ ¼å¼æ­£ç¡®

**Q: ç¿»è¯‘é”®å†²çª**
A: ä½¿ç”¨æ›´å…·ä½“çš„å‘½åç©ºé—´ï¼Œæˆ–æ‰‹åŠ¨è°ƒæ•´ç”Ÿæˆçš„é”®å

**Q: æ€§èƒ½é—®é¢˜**
A: å¯¹å¤§å‹é¡¹ç›®ï¼Œè€ƒè™‘åˆ†æ‰¹å¤„ç†æˆ–ä½¿ç”¨excludePatternså‡å°‘æ‰«æèŒƒå›´

### è°ƒè¯•æ¨¡å¼
```bash
# è¿è¡Œè·¯å¾„è¯Šæ–­
npm run diagnostic

# å¿«é€Ÿä¿®å¤è·¯å¾„é—®é¢˜
npm run quick-fix

# æµ‹è¯•ç‰¹å®šç›®å½•æ‰«æ
node i18n-scanner.js ../frontEnd/src ./test-output

# å¯ç”¨è¯¦ç»†æ—¥å¿—
DEBUG=i18n:* npm run workflow
```

## æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„æ–‡æœ¬æ¨¡å¼
```javascript
// åœ¨i18n-scanner.jsä¸­æ·»åŠ æ–°çš„æ­£åˆ™æ¨¡å¼
this.patterns.push(
    /customFunction\(['"`]([^'"`]*[\u4e00-\u9fa5][^'"`]*)['"`]\)/g
);
```

### è‡ªå®šä¹‰ç¿»è¯‘é”®ç”Ÿæˆ
```javascript
// é‡å†™generateKeyæ–¹æ³•
generateKey(text, filePath) {
    // è‡ªå®šä¹‰é”®åç”Ÿæˆé€»è¾‘
    return `custom_${text.length}_${Date.now()}`;
}
```

### é›†æˆå…¶ä»–å·¥å…·
```javascript
// æ·»åŠ æ–°çš„éªŒè¯è§„åˆ™
class CustomValidator extends I18nValidator {
    async customCheck() {
        // è‡ªå®šä¹‰æ£€æŸ¥é€»è¾‘
    }
}
```

## è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»ºPull Request

## è®¸å¯è¯

MIT License - è¯¦è§LICENSEæ–‡ä»¶
